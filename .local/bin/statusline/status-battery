#!/bin/sh

COLORED_EMOJIS=$1

batinfo=$(acpi | grep "Battery 0:")
batper=$(echo $batinfo | cut -d " " -f 4 | sed 's/\,//;s/\%//')
bat=$(( $batper / 10 ))

if [ "$bat" -le 1 ]; then
    if [ ! -f /tmp/batwarning ]; then
        echo 1 > /tmp/batwarning
        dunstify -a "system" -i battery-empty -r "90909090" "Battery critical" "Your battery level is 10%, please consider charging"
        canberra-gtk-play -i dialog-warning
    fi
elif [ "$bat" -le 2 ]; then
    if [ ! -f /tmp/batwarning ]; then
        echo 1 > /tmp/batwarning
        dunstify -a "system" -i battery-low -r "90909090" "Battery warning" "Your battery level is 20%, please consider charging"
        canberra-gtk-play -i dialog-warning
    fi
else
    rm -f /tmp/batwarning
fi

[ ! "$COLORED_EMOJIS" = true ] && icon="ï–" || icon="ğŸ”‹"

if [ ! "$COLORED_EMOJIS" = true ]; then
    case $bat in
        "1")  icon="ï•¹";;
        "2")  icon="ï•º";;
        "3")  icon="ï•»";;
        "4")  icon="ï•¼";;
        "5")  icon="ï•¼";;
        "6")  icon="ï•¾";;
        "7")  icon="ï•¿";;
        "8")  icon="ï–€";;
        "9")  icon="ï–€";;
        "10") icon="ï•¸";;
    esac
fi

char=$(echo $batinfo | cut -d " " -f 3 | sed 's/\,//')
[ $char = "Charging" ] && ([ ! "$COLORED_EMOJIS" = true ] && icon="ï–ƒ" || icon="ğŸ”Œ")

echo "$icon $batper%"
